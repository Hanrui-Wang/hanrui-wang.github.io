<!doctype html>
<html>

<head>
  <title> HAT: Hardware-Aware Transformers for Efficient Natural Language Processing</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.2.1.min.js"
    integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
  <link href="style_extra.css" rel="stylesheet">
</head>

<body class="nd-docs">
  <div class="nd-pageheader">
    <div class="container">
      <p class="lead" style="font-size:300%;">
        HAT: Hardware-Aware Transformers for Efficient Natural Language Processing
        <address>
                    <nobr>
            <a href="https://hanruiwang.me">Hanrui Wang</a>
            <sup>1</sup>
            ,
          </nobr>
                    <nobr>
            <a href="https://zhanghaowu.me">Zhanghao Wu</a>
            <sup>1</sup>
            ,
          </nobr>
                    <nobr>
            <a href="http://zhijianliu.com">Zhijian Liu</a>
            <sup>1</sup>
            ,
          </nobr>
                    <nobr>
            <a href="https://han-cai.github.io/">Han Cai</a>
            <sup>1</sup>
            ,
          </nobr>
                    <nobr>
            <a href="https://lzhu.me">Ligeng Zhu</a>
            <sup>1</sup>
            ,
          </nobr>
                    <nobr>
            <a href="http://people.csail.mit.edu/ganchuang/">Chuang Gan</a>
            <sup>2</sup>
            ,
          </nobr>
                    <nobr>
            <a href="https://songhan.mit.edu">Song Han</a>
            <sup>1</sup>
            
          </nobr>
                    <br>
                    <nobr><sup>1</sup>Massachusetts Institute of Technology,</nobr>
                    <nobr><sup>2</sup>MIT-IBM Watson AI Lab</nobr>
                  </address>
      </p>
    </div>
  </div> <!-- end nd-pageheader -->

  <div class="container">

    <div class="row">
      <div class="col text-center">
        <p>
                    <a href="assets/HanruiWang_ACL2020_Hardware-aware-transformers.pdf" class="d-inline-block p-3 align-top">
            <img height="100" width="70" src="assets/paper_thumbnail.png" style="border:1px solid"
              data-nothumb><br>
            ACL 2020 Paper
          </a>
                </div>
    </div>

    <div class="row">
      <div class="col">

                
                <p><p>Transformers are ubiquitous in Natural Language Processing (NLP) tasks, but they are difficult to be deployed on hardware due to the intensive computation. To enable low-latency inference on resource-constrained hardware platforms, we propose to design Hardware-Aware Transformers (HAT) with neural architecture search. We first construct a large design space with arbitrary encoder-decoder attention and heterogeneous layers. Then we train a SuperTransformer that covers all candidates in the design space, and efficiently produces many SubTransformers with weight sharing. Finally, we perform an evolutionary search with a hardware latency constraint to find a specialized SubTransformer dedicated to run fast on the target hardware. Extensive experiments on four machine translation tasks demonstrate that HAT can discover efficient models for different hardware (CPU, GPU, IoT device). When running WMT’14 translation task on Raspberry Pi-4, HAT can achieve 3× speedup, 3.7× smaller size over baseline Transformer; 2.7× speedup, 3.6× smaller size over Evolved Transformer with 12,041× less search cost and no performance loss.</p></p>
        
                        
                <p><p align="center">
    <img src="assets/overview.jpg" width="80%">
</p></p>
        
                                <h2>Results on WMT 14' En-De and En-Fr translation tasks</h2>
        
                <p><p align="center">
    <img src="assets/results.jpg" width="80%">
</p></p>
        
                                <h2>Citation</h2>
        
        
                <pre class="highlight"> @inproceedings{wang2020hat,
    title     = {HAT: Hardware-Aware Transformers for Efficient Natural Language Processing},
    author    = {Wang, Hanrui and Wu, Zhanghao and Liu, Zhijian and Cai, Han and Zhu, Ligeng and Gan, Chuang and Han, Song},
    booktitle = {Annual Conference of the Association for Computational Linguistics},
    year      = {2020}
} </pre>
                        
                <p><p><strong>Acknowledgments</strong>: We sincerely thank NSF Career Award #1943349, MIT-IBM Watson AI Lab, Semi-conductor Research Corporation (SRC), Intel, and Facebook for supporting this research.</p></p>
        
                
      </div>
    </div> <!-- row -->

  </div> <!-- container -->

  <script>
    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
      coll[i].addEventListener("click", function () {
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
        } else {
          content.style.maxHeight = content.scrollHeight * 50 + "px";
        }
        content.style.height = "550%";
      });
    }
  </script>
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
  
  <script type="text/javascript"
      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
</body>

</html>